{"version":3,"mappings":"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","names":["_angular_core__WEBPACK_IMPORTED_MODULE_7__","EventComponent","eventService","authService","dialog","router","url","slice","length","loadPageContent","split","path","getIdForPath","subscribe","id","currentPathId","getContent","result","loadContent","categorys","elements","undefined","console","log","items","imageContent","category","push","front","_id","name","image","leftClick","navigate","bind","rightClick","openSettings","item","openCreateCategory","swapSelection","canView","isInEditing","back","event","content","parent","flipped","popupMenu","fields","event2","openDeleteDialog","openMenu","open","src_app_shared_dialog_form_dialog_form_component__WEBPACK_IMPORTED_MODULE_1__","instance","componentInstance","title","submit","createCategory","getValue","description","keywords","close","error","startsWith","deleteCategory","substring","deleteElement","selectors","viewQuery","src_app_shared_popup_menu_popup_menu_component__WEBPACK_IMPORTED_MODULE_0__","_r1","_r3","EventModule","_angular_common__WEBPACK_IMPORTED_MODULE_7__","_layout_loading_loading_module__WEBPACK_IMPORTED_MODULE_1__","src_app_shared_dialog_form_dialog_form_module__WEBPACK_IMPORTED_MODULE_2__","src_app_shared_image_view_image_view_module__WEBPACK_IMPORTED_MODULE_3__","src_app_shared_content_header_content_header_module__WEBPACK_IMPORTED_MODULE_4__","src_app_shared_popup_menu_popup_menu_module__WEBPACK_IMPORTED_MODULE_5__","_angular_router__WEBPACK_IMPORTED_MODULE_8__","component","_event_component__WEBPACK_IMPORTED_MODULE_0__","declarations","imports","EventService","httpClient","post","_api_api_service__WEBPACK_IMPORTED_MODULE_0__","ROUTE_ELEMENT","options","ROUTE_CATEGORY","parentId","Object","_parentId","categoryId","element","_categoryId","elementId","_content_service__WEBPACK_IMPORTED_MODULE_1__","t","factory","providedIn"],"sources":["webpack:///src/app/components/event/event.component.html","webpack:///src/app/components/event/event.component.ts","webpack:///src/app/components/event/event.module.ts","webpack:///src/app/service/content/impl/event.service.ts"],"sourcesContent":["<div *ngIf='imageContent; then loadedTemplate; else loadingTemplate'></div>\r\n<ng-template #loadedTemplate>\r\n    <app-content-header title=\"Events\"></app-content-header>\r\n    <app-image-view [content]=\"this.imageContent\"></app-image-view>\r\n    <app-popup-menu></app-popup-menu>\r\n</ng-template>\r\n\r\n<ng-template #loadingTemplate>\r\n    <app-loading></app-loading>\r\n</ng-template>","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { AuthService } from 'src/app/service/auth/auth.service';\r\nimport { MatDialog } from '@angular/material/dialog';\r\nimport { ImageViewContent, ImageViewContentElement } from 'src/app/shared/image-view/image-view.component';\r\nimport { PopupMenuComponent } from 'src/app/shared/popup-menu/popup-menu.component';\r\nimport { Event, EventCategory, EventService } from 'src/app/service/content/impl/event.service';\r\nimport { Router } from '@angular/router';\r\nimport { DialogFormComponent } from 'src/app/shared/dialog-form/dialog-form.component';\r\n\r\n@Component({\r\n  selector: 'app-event',\r\n  templateUrl: './event.component.html',\r\n  styleUrls: ['./event.component.css']\r\n})\r\nexport class EventComponent implements OnInit {\r\n\r\n  imageContent: ImageViewContent[] = [];\r\n\r\n  @ViewChild(PopupMenuComponent) popupMenu: PopupMenuComponent;\r\n\r\n  currentPathId: string;\r\n\r\n  constructor(\r\n    private eventService: EventService,\r\n    private authService: AuthService,\r\n    private dialog: MatDialog,\r\n    private router: Router\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    let url = this.router.url;\r\n    url = url.slice(6, url.length);\r\n    this.loadPageContent(url.length > 0 ? url.split('/') : []);\r\n  }\r\n\r\n  loadPageContent(path: string[]) {\r\n    if (path.length > 0) {\r\n      this.eventService.getIdForPath(path).subscribe(id => {\r\n        if (id) {\r\n          this.currentPathId = id.id;\r\n          this.eventService.getContent(this.currentPathId).subscribe(result => {\r\n            if (result) {\r\n              this.loadContent(result.categorys, result.elements);\r\n            }\r\n          });\r\n        }\r\n      });\r\n    } else {\r\n      this.currentPathId = undefined;\r\n      this.eventService.getContent(undefined).subscribe(result => {\r\n        console.log('CONTENT UPDATE ' + result);\r\n        if (result) {\r\n          this.loadContent(result.categorys, result.elements);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  loadContent(categorys: EventCategory[], items: Event[]) {\r\n    const imageContent: ImageViewContent[] = [];\r\n    if (categorys) {\r\n      for (const category of categorys) {\r\n        imageContent.push({\r\n          front: {\r\n            id: `C_${category._id}`,\r\n            name: category.name,\r\n            image: category.image,\r\n            leftClick: (() => this.router.navigate([`${this.router.url}/${category.name}`])).bind(this),\r\n            rightClick: this.openSettings.bind(this)\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    if (items) {\r\n      for (const item of items) {\r\n        imageContent.push({\r\n          front: {\r\n            id: `I_${item._id}`,\r\n            name: item.name,\r\n            image: item.image,\r\n            rightClick: this.openSettings.bind(this)\r\n          }\r\n        });\r\n      }\r\n    }\r\n\r\n    imageContent.push({\r\n      front: {\r\n        name: 'Create Item',\r\n        image: 'assets/image/create_item.png',\r\n        leftClick: this.openCreateCategory.bind(this),\r\n        rightClick: this.swapSelection.bind(this),\r\n        canView: this.authService.isInEditing.bind(this),\r\n      },\r\n      back: {\r\n        name: \"Create Category\",\r\n        image: 'assets/image/create_category.png',\r\n        leftClick: this.openCreateCategory.bind(this),\r\n        rightClick: this.swapSelection.bind(this),\r\n        canView: this.authService.isInEditing.bind(this),\r\n      }\r\n    });\r\n\r\n    this.imageContent = imageContent;\r\n  }\r\n\r\n  swapSelection(event: MouseEvent, content: ImageViewContentElement) {\r\n    content.parent.flipped = !content.parent.flipped;\r\n    return true;\r\n  }\r\n\r\n  openSettings(event: MouseEvent, content: ImageViewContentElement) {\r\n    if (!this.authService.isInEditing()) {\r\n      return false;\r\n    }\r\n\r\n    this.popupMenu.fields = [\r\n      {\r\n        name: 'Delete',\r\n        leftClick: ((event2) => this.openDeleteDialog(event2, content)).bind(this)\r\n      }];\r\n    this.popupMenu.openMenu(event);\r\n    return true;\r\n  }\r\n\r\n  openCreateCategory(event: MouseEvent, content: ImageViewContentElement) {\r\n    if (!this.authService.isInEditing()) {\r\n      return false;\r\n    }\r\n\r\n    const dialog = this.dialog.open(DialogFormComponent);\r\n    const instance = dialog.componentInstance;\r\n    instance.title = \"Create event\";\r\n    instance.fields = [{\r\n      id: 'name',\r\n      name: 'Name'\r\n    }];\r\n    instance.submit = () => {\r\n      instance.title = \"Loading\";\r\n      this.eventService.createCategory(undefined, {\r\n        name: instance.getValue('name'),\r\n        description: '',\r\n        image: '',\r\n        keywords: []\r\n      }).subscribe(res => {\r\n        instance.title = \"Success\";\r\n        this.eventService.getContent(this.currentPathId, false).subscribe();\r\n        dialog.close();\r\n      }, error => {\r\n        console.log(error);\r\n      });\r\n    }\r\n    return true;\r\n  }\r\n\r\n  openDeleteDialog(event: MouseEvent, content: ImageViewContentElement): boolean {\r\n    if (!this.authService.isInEditing()) {\r\n      return false;\r\n    }\r\n\r\n    const dialog = this.dialog.open(DialogFormComponent);\r\n    const instance = dialog.componentInstance;\r\n    instance.title = \"Delete\";\r\n    instance.submit = () => {\r\n      instance.title = \"Loading\";\r\n      if (content.id.startsWith('C_')) {\r\n        this.eventService.deleteCategory(content.id.substring(2)).subscribe(() => {\r\n          this.eventService.getContent(this.currentPathId, false).subscribe();\r\n          dialog.close();\r\n        });\r\n        return;\r\n      }\r\n      this.eventService.deleteElement(content.id.substring(2)).subscribe(() => {\r\n        this.eventService.getContent(this.currentPathId, false).subscribe();\r\n        dialog.close();\r\n      });\r\n    }\r\n    return true;\r\n  }\r\n}","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RouterModule } from '@angular/router';\r\nimport { EventComponent } from './event.component';\r\nimport { LoadingModule } from '../layout/loading/loading.module';\r\nimport { DialogFormModule } from 'src/app/shared/dialog-form/dialog-form.module';\r\nimport { ImageViewModule } from 'src/app/shared/image-view/image-view.module';\r\nimport { ContentHeaderModule } from 'src/app/shared/content-header/content-header.module';\r\nimport { PopupMenuModule } from 'src/app/shared/popup-menu/popup-menu.module';\r\n\r\n@NgModule({\r\n  declarations: [EventComponent],\r\n  imports: [\r\n    CommonModule,\r\n    LoadingModule,\r\n    DialogFormModule,\r\n    ImageViewModule,\r\n    ContentHeaderModule,\r\n    PopupMenuModule,\r\n\r\n    RouterModule.forChild([\r\n      {\r\n        path: '',\r\n        component: EventComponent\r\n      }\r\n    ])\r\n  ]\r\n})\r\nexport class EventModule { }\r\n","import { Injectable } from \"@angular/core\";\r\nimport { Observable } from \"rxjs\";\r\nimport { ApiService } from \"../../api/api.service\";\r\nimport { ContentService, ICategory, IElement, Response, SearchElementOptions } from \"../content.service\";\r\n\r\nexport interface EventCategory extends ICategory {\r\n\tname: string,\r\n\timage: string,\r\n\tdescription: string,\r\n\tkeywords: string[]\r\n}\r\n\r\nexport interface Event extends IElement {\r\n\tname: string,\r\n\timage: string,\r\n\tdescription: string,\r\n\tkeywords: string[]\r\n}\r\n\r\n@Injectable({\r\n\tprovidedIn: 'root'\r\n})\r\nexport abstract class EventService extends ContentService<EventCategory, Event> {\r\n\r\n\tpublic static readonly ROUTE_ELEMENT = \"event\";\r\n\tpublic static readonly ROUTE_CATEGORY = \"event/category\";\r\n\r\n\t_getIdForPath(path: string[]): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_ELEMENT}/path`, { path });\r\n\t}\r\n\r\n\t_getCategorys(options: SearchElementOptions): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_CATEGORY}`, options);\r\n\t}\r\n\r\n\t_getElements(options: SearchElementOptions): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_ELEMENT}`, options);\r\n\t}\r\n\r\n\t_createCategory(parentId: string, category: EventCategory): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_CATEGORY}/create`, { ...category, _parentId: parentId } );\r\n\t}\r\n\r\n\t_createElement(categoryId: string, element: Event): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_ELEMENT}/create`, { ...element, _categoryId: categoryId } );\r\n\t}\r\n\r\n\t_updateCategory(categoryId: string, category: EventCategory): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_CATEGORY}/update`, { ...category, _id: categoryId });\r\n\t}\r\n\r\n\t_updateElement(elementId: string, element: Event): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_ELEMENT}/update`, {  ...element, _id: elementId });\r\n\t}\r\n\r\n\t_deleteCategory(categoryId: string): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_CATEGORY}/delete`, { _id: categoryId });\r\n\t}\r\n\r\n\t_deleteElement(elementId: string): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${EventService.ROUTE_ELEMENT}/delete`, { _id: elementId });\r\n\t}\r\n}"]}