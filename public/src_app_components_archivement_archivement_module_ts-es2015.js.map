{"version":3,"file":"src_app_components_archivement_archivement_module_ts-es2015.js","mappings":"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","sources":["./src/app/components/archivement/archivement.component.ts","./src/app/components/archivement/archivement.component.html","./src/app/components/archivement/archivement.module.ts","./src/app/service/content/impl/archivement.service.ts"],"sourcesContent":["import { Component, OnInit, ViewChild } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Router } from '@angular/router';\nimport { AuthService } from 'src/app/service/auth/auth.service';\nimport { Archivement, ArchivementCategory, ArchivementService } from 'src/app/service/content/impl/archivement.service';\nimport { ImageViewContent } from 'src/app/shared/image-view/image-view.component';\nimport { PopupMenuComponent } from 'src/app/shared/popup-menu/popup-menu.component';\n\n@Component({\n  selector: 'app-archivement',\n  templateUrl: './archivement.component.html',\n  styleUrls: ['./archivement.component.css']\n})\nexport class ArchivementComponent implements OnInit {\n\n  imageContent: ImageViewContent[] = [];\n\n  @ViewChild(PopupMenuComponent) popupMenu: PopupMenuComponent;\n\n  constructor(\n    private archivementService: ArchivementService,\n    private router: Router,\n    public authService: AuthService,\n    public dialog: MatDialog\n  ) { }\n\n  ngOnInit() {\n    let url = this.router.url;\n    url = url.slice(6, url.length);\n    this.loadPageContent(url.length > 0 ? url.split('/') : []);\n  }\n\n  loadPageContent(path: string[]) {\n    if (path.length > 0) {\n      this.archivementService.getIdForPath(path).subscribe(id => {\n        if (id) {\n          this.archivementService.getContent(id.id).subscribe(result => {\n            if (result) {\n              this.loadContent(result.categorys, result.elements);\n            }\n          });\n        }\n      });\n    } else {\n      this.archivementService.getContent(undefined).subscribe(result => {\n        if (result) {\n          this.loadContent(result.categorys, result.elements);\n        }\n      });\n    }\n  }\n\n  loadContent(categorys: ArchivementCategory[], items: Archivement[]) {\n    const imageContent: ImageViewContent[] = [];\n    if (categorys) {\n      for (const category of categorys) {\n        imageContent.push({\n          front: {\n            id: category._id,\n            name: category.name,\n            image: category.image,\n            leftClick: (() => this.router.navigate([`${this.router.url}/${category.name}`])).bind(this)\n          }\n        });\n      }\n    }\n\n    if (items) {\n      for (const item of items) {\n        imageContent.push({\n          front: {\n            id: item._id,\n            name: item.name,\n            image: item.image,\n            rightClick: this.openSettings.bind(this)\n          }\n        });\n      }\n    }\n\n    imageContent.push({\n      front: {\n        name: 'Create',\n        image: 'https://cv.wuffy.eu/new/images/event.png',\n        canView: this.authService.isInEditing.bind(this)\n      }\n    });\n\n    this.imageContent = imageContent;\n  }\n\n  openSettings(event: MouseEvent, content: ImageViewContent) {\n    if (!this.authService.isInEditing()) {\n      return false;\n    }\n\n    this.popupMenu.fields = [{\n      name: 'Update',/* \n      leftClick: ((event2) => this.openUpdateDialog(event2, content)).bind(this) */\n    },\n    {\n      name: 'Delete',/* \n      leftClick: ((event2) => this.openDeleteDialog(event2, content)).bind(this) */\n    }];\n    this.popupMenu.openMenu(event);\n    return true;\n  }\n\n  /*   openCreateDialog(): boolean {\n      if (!this.authService.isInEditing()) {\n        return false;\n      }\n  \n      const dialog = this.dialog.open(DialogFormComponent);\n      const instance = dialog.componentInstance;\n      instance.submit = () => {\n        this.archivementService.createArchivement(instance.getValue('name'), instance.getValue('description'), instance.getValue('image'), (callback) => {\n          if (callback.success) {\n            dialog.close();\n          } else {\n            instance.error = callback.errors.length > 0 ? callback.errors[0].msg : 'Unknown error';\n          }\n        });\n      }\n  \n      instance.title = \"Create event\";\n      instance.submitName = \"Create\";\n      instance.fields = [{\n        id: 'name',\n        name: 'Name'\n      },\n      {\n        id: 'description',\n        name: 'Description'\n      },\n      {\n        id: 'image',\n        name: 'Image'\n      }];\n      return true;\n    }\n  \n    openUpdateDialog(event: MouseEvent, content: ImageViewContent) {\n      const dialog = this.dialog.open(DialogFormComponent);\n      const instance = dialog.componentInstance;\n      instance.submit = () => {\n        this.archivementService.updateArchivement(content.id, (callback) => {\n          if (callback.success) {\n            dialog.close();\n          } else {\n            instance.error = callback.errors.length > 0 ? callback.errors[0].msg : 'Unknown error';\n          }\n        }, instance.getValue('name'), instance.getValue('description'), instance.getValue('image'));\n      }\n  \n      instance.title = 'Update archivement';\n      instance.submitName = 'Update';\n      this.archivementService.getArchivementById(content.id).subscribe(archivement => {\n        instance.fields = [{\n          id: 'name',\n          name: 'Name',\n          value: archivement.name\n        },\n        {\n          id: 'description',\n          name: 'Description',\n          value: archivement.description\n        },\n        {\n          id: 'image',\n          name: 'Image',\n          value: archivement.image\n        }];\n      });\n    }\n  \n    openDeleteDialog(event: MouseEvent, content: ImageViewContent) {\n      const dialog = this.dialog.open(DialogFormComponent);\n      const instance = dialog.componentInstance;\n  \n      instance.title = instance.submitName = \"Delete\";\n      instance.submit = () => {\n        this.archivementService.deleteArchivement(content.id, (callback) => {\n          if (callback.success) {\n            dialog.close();\n          } else {\n            instance.error = callback.errors.length > 0 ? callback.errors[0].msg : 'Unknown error';\n          }\n        });\n      }\n    } */\n}","<div *ngIf='imageContent; then loadedTemplate; else loadingTemplate'></div>\n<ng-template #loadedTemplate>\n    <app-content-header title=\"Archivements\"></app-content-header>\n    <app-image-view [content]=\"this.imageContent\"></app-image-view>\n    <app-popup-menu></app-popup-menu>\n</ng-template>\n\n<ng-template #loadingTemplate>\n    <app-loading></app-loading>\n</ng-template>","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { LoadingModule } from '../layout/loading/loading.module';\nimport { RouterModule } from '@angular/router';\nimport { ArchivementComponent } from './archivement.component';\nimport { DialogFormModule } from 'src/app/shared/dialog-form/dialog-form.module';\nimport { ImageViewModule } from 'src/app/shared/image-view/image-view.module';\nimport { ContentHeaderModule } from 'src/app/shared/content-header/content-header.module';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatButtonModule } from '@angular/material/button';\nimport { PopupMenuModule } from 'src/app/shared/popup-menu/popup-menu.module';\n\n\n\n@NgModule({\n  declarations: [ArchivementComponent],\n  imports: [\n    CommonModule,\n    MatMenuModule,\n    MatButtonModule,\n    DialogFormModule,\n    LoadingModule,\n    ImageViewModule,\n    ContentHeaderModule,\n    PopupMenuModule,\n    LoadingModule,\n    ImageViewModule,\n    ContentHeaderModule,\n    PopupMenuModule,\n\n    RouterModule.forChild([\n      {\n        path: '',\n        component: ArchivementComponent\n      }\n    ])\n  ]\n})\nexport class ArchivementModule { }\n","import { Injectable } from \"@angular/core\";\r\nimport { Observable } from \"rxjs\";\r\nimport { ApiService } from \"../../api/api.service\";\r\nimport { ContentService, ICategory, IElement, Response, SearchElementOptions } from \"../content.service\";\r\n\r\nexport interface ArchivementCategory extends ICategory {\r\n\tname: string,\r\n\timage: string,\r\n\tdescription: string\r\n\tkeywords: string[]\r\n}\r\n\r\nexport interface Archivement extends IElement {\r\n\tname: string,\r\n\timage: string,\r\n\tvideo: string,\r\n\tdescription: string,\r\n\tchecklist: {\r\n\t\t\tmodel: string,\r\n\t\t\tname: string,\r\n\t\t\tdescription: string,\r\n\t\t\tvalue: [string]\r\n\t}[],\r\n\tkeywords: string[]\r\n}\r\n\r\n@Injectable({\r\n\tprovidedIn: 'root'\r\n})\r\nexport abstract class ArchivementService extends ContentService<ArchivementCategory, Archivement> {\r\n\r\n\tpublic static readonly ROUTE_ELEMENT = \"archivement\";\r\n\tpublic static readonly ROUTE_CATEGORY = \"archivement/category\";\r\n\r\n\t_getIdForPath(path: string[]): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_ELEMENT}/path`, { path });\r\n\t}\r\n\r\n\t_getCategorys(options: SearchElementOptions): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_CATEGORY}`, options);\r\n\t}\r\n\r\n\t_getElements(options: SearchElementOptions): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_ELEMENT}`, options);\r\n\t}\r\n\r\n\t_createCategory(parentId: string, category: ArchivementCategory): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_CATEGORY}/create`, { ...category, _parentId: parentId } );\r\n\t}\r\n\r\n\t_createElement(categoryId: string, element: Archivement): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_ELEMENT}/create`, { ...element, _categoryId: categoryId } );\r\n\t}\r\n\r\n\t_updateCategory(categoryId: string, category: ArchivementCategory): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_CATEGORY}/update`, { ...category, _id: categoryId });\r\n\t}\r\n\r\n\t_updateElement(elementId: string, element: Archivement): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_ELEMENT}/update`, {  ...element, _id: elementId });\r\n\t}\r\n\r\n\t_deleteCategory(categoryId: string): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_CATEGORY}/delete`, { _id: categoryId });\r\n\t}\r\n\r\n\t_deleteElement(elementId: string): Observable<Response> {\r\n\t\treturn this.httpClient.post<Response>(`${ApiService.DOMAIN}/${ArchivementService.ROUTE_ELEMENT}/delete`, { _id: elementId });\r\n\t}\r\n}"],"names":[],"sourceRoot":"webpack:///"}